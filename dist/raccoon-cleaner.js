class t{static initAll(){document.querySelectorAll(".raccoon-cleaner").forEach((e=>new t(e)))}constructor(t){this.f=t,this.buildDOM(),this.bind(),this.sync()}buildDOM(){this.wrap=document.createElement("span"),this.wrap.className="rac-wrap",this.f.parentNode.insertBefore(this.wrap,this.f),this.wrap.appendChild(this.f),this.bin=document.createElement("button"),this.bin.className="rac-bin",this.bin.textContent="ðŸ—‘ï¸",this.bin.setAttribute("aria-label","Clear"),this.wrap.appendChild(this.bin)}bind(){this.f.addEventListener("input",(()=>this.sync())),window.addEventListener("resize",(()=>this.sync())),this.bin.addEventListener("click",(()=>this.runShow()))}sync(){const t=!!this.f.value.trim();this.cleaning||this.bin.classList.toggle("show",t);const e=this.f.getBoundingClientRect(),i=getComputedStyle(this.f),s=parseFloat(i.paddingTop),n=parseFloat(i.paddingBottom),a=s+(e.height-s-n)/2;this.bin.style.top=`${a}px`}runShow(){if(!this.f.value.trim()||this.cleaning)return;this.cleaning=!0,this.bin.classList.add("busy");const t=this.f.placeholder;this.f.placeholder="",this.f.disabled=!0;const e=document.createElement("span");e.className="rac-txt",e.textContent=this.f.value,this.wrap.appendChild(e),e.style.fontSize=getComputedStyle(this.f).fontSize;const i=document.createElement("span");i.className="rac-coon",i.textContent="ðŸ¦",this.wrap.appendChild(i);const s=this.wrap.getBoundingClientRect(),n=this.f.getBoundingClientRect(),a=getComputedStyle(this.f),l=parseFloat(a.paddingLeft),o=parseFloat(a.borderLeftWidth),h=parseFloat(a.paddingTop)+(n.height-parseFloat(a.paddingTop)-parseFloat(a.paddingBottom))/2;e.style.top=i.style.top=`${h}px`;const c=o+l;e.style.left=`${c}px`;const d=e.getBoundingClientRect().width,p=s.width-parseFloat(a.paddingRight)-26;i.style.left=`${p}px`;const r=c+d+6,f=()=>{const t=parseFloat(i.style.left);t-8>r?(i.style.left=t-8+"px",requestAnimationFrame(f)):(i.style.left=`${r}px`,u())};f();const u=()=>{this.f.value="",this.sync();const t=p-c;let s=0;!function n(){const a=Math.min(12,t-s);s+=a,e.style.left=`${c+s}px`,i.style.left=`${r+s}px`,s<t?setTimeout(n,70+100*Math.random()):m()}()},m=()=>{e.style.opacity=i.style.opacity=this.bin.style.opacity=0,setTimeout((()=>{e.remove(),i.remove(),this.f.disabled=!1,this.f.placeholder=t,this.bin.className="rac-bin",this.bin.style.opacity="",this.cleaning=!1,this.sync()}),300)}}}document.addEventListener("DOMContentLoaded",(()=>t.initAll()));export{t as RaccoonCleaner};
//# sourceMappingURL=raccoon-cleaner.js.map
